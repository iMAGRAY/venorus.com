# Руководство по системе характеристик товаров МедСИП

## Обзор системы

Система характеристик товаров позволяет создавать, редактировать и управлять детальными характеристиками каждого продукта в каталоге МедСИП. Каждая характеристика содержит название, значение, тип, единицы измерения и другие метаданные.

## Структура базы данных

### Таблица `product_specifications`

```sql
CREATE TABLE product_specifications (
    id SERIAL PRIMARY KEY,
    product_id INTEGER NOT NULL REFERENCES products(id) ON DELETE CASCADE,
    spec_name VARCHAR(100) NOT NULL,        -- Название характеристики
    spec_value TEXT NOT NULL,               -- Значение характеристики
    spec_type VARCHAR(50) DEFAULT 'text',   -- Тип характеристики
    unit VARCHAR(20),                       -- Единица измерения
    numeric_value DECIMAL(10,3),           -- Числовое значение для сортировки
    is_primary BOOLEAN DEFAULT false,       -- Основная характеристика
    sort_order INTEGER DEFAULT 0,          -- Порядок сортировки
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

### Поля таблицы

- **id**: Уникальный идентификатор характеристики
- **product_id**: ID товара (связь с таблицей products)
- **spec_name**: Название характеристики (например: "Вес", "Время работы")
- **spec_value**: Значение характеристики (например: "1.2 кг", "16 часов")
- **spec_type**: Тип характеристики для категоризации и валидации
- **unit**: Единица измерения (кг, часы, годы, см и т.д.)
- **numeric_value**: Числовое значение для сортировки и фильтрации
- **is_primary**: Флаг основной характеристики (отображается в списках)
- **sort_order**: Порядок отображения характеристик
- **created_at/updated_at**: Временные метки

## API Endpoints

### GET /api/product-specifications

Получение характеристик товаров.

**Параметры запроса:**
- `productId` - ID товара для фильтрации
- `includePrimary=true` - только основные характеристики

**Примеры:**
```bash
# Все характеристики
GET /api/product-specifications

# Характеристики конкретного товара
GET /api/product-specifications?productId=1

# Только основные характеристики
GET /api/product-specifications?includePrimary=true
```

### POST /api/product-specifications

Создание новой характеристики.

**Тело запроса:**
```json
{
  "productId": 1,
  "specName": "Вес",
  "specValue": "1.2 кг",
  "specType": "weight",
  "unit": "кг",
  "numericValue": 1.2,
  "isPrimary": true,
  "sortOrder": 1
}
```

### PUT /api/product-specifications/[id]

Обновление существующей характеристики.

### DELETE /api/product-specifications/[id]

Удаление характеристики.

## Типы характеристик

Система поддерживает следующие типы характеристик:

1. **text** - Текстовые характеристики
2. **number** - Числовые значения
3. **weight** - Характеристики веса
4. **duration** - Время работы, время зарядки
5. **warranty** - Гарантийные обязательства
6. **material** - Материалы изготовления
7. **dimension** - Размерные характеристики
8. **temperature** - Температурные режимы
9. **power** - Мощность и энергопотребление
10. **voltage** - Напряжение
11. **current** - Сила тока
12. **pressure** - Давление
13. **speed** - Скорость
14. **frequency** - Частота

## Использование в админ-панели

### Доступ к характеристикам

1. Откройте админ-панель `/admin/model-lines`
2. Найдите нужный товар в списке
3. Нажмите кнопку **"Характеристики"** рядом с кнопкой "Размеры"

### Создание характеристики

1. В диалоге характеристик нажмите **"Добавить новую характеристику"**
2. Заполните обязательные поля:
   - **Название характеристики** (например: "Вес")
   - **Значение** (например: "1.2 кг")
3. Выберите **тип характеристики** из выпадающего списка
4. Укажите **единицу измерения** (опционально)
5. Введите **числовое значение** для сортировки (опционально)
6. Отметьте **"Основная характеристика"** если нужно
7. Задайте **порядок сортировки**
8. Нажмите **"Добавить характеристику"**

### Редактирование характеристики

1. В списке характеристик нажмите кнопку редактирования (карандаш)
2. Измените нужные поля
3. Нажмите **"Обновить характеристику"**

### Удаление характеристики

1. В списке характеристик нажмите кнопку удаления (корзина)
2. Подтвердите удаление в диалоге

## Примеры характеристик

### Для протезов рук
```
Вес: 1.2 кг (weight, основная)
Время работы: 16 часов (duration, основная)
Время зарядки: 2 часа (duration)
Гарантия: 2 года (warranty, основная)
Материал: Титановый сплав (material)
Максимальная нагрузка: 50 кг (number, основная)
Степень защиты: IP67 (text)
```

### Для протезов ног
```
Вес: 2.8 кг (weight, основная)
Максимальная нагрузка: 120 кг (number, основная)
Материал: Карбон (material)
Гарантия: 3 года (warranty, основная)
Амортизация: Гидравлическая (text)
```

### Для экзоскелетов
```
Вес: 15 кг (weight, основная)
Время работы: 8 часов (duration, основная)
Максимальная нагрузка: 200 кг (number, основная)
Питание: Li-ion аккумулятор (text)
Рабочая температура: -10°C до +45°C (temperature)
```

## Лучшие практики

### Именование характеристик
- Используйте понятные названия: "Вес", "Время работы", "Гарантия"
- Избегайте аббревиатур и технического жаргона
- Сохраняйте единообразие в названиях

### Значения характеристик
- Всегда указывайте единицы измерения: "1.2 кг", "16 часов"
- Используйте стандартные единицы измерения
- Будьте точны в числовых значениях

### Типизация
- Выбирайте правильный тип характеристики
- Используйте числовые поля для сортировки и фильтрации
- Отмечайте основные характеристики для отображения в каталоге

### Порядок сортировки
- Основные характеристики должны идти первыми (порядок 1-10)
- Дополнительные характеристики - после основных (порядок 11+)
- Логично группируйте похожие характеристики

## Интеграция с каталогом

Система характеристик полностью интегрирована с каталогом товаров:

1. **Связь с товарами**: Каждая характеристика привязана к конкретному товару
2. **Каскадное удаление**: При удалении товара все его характеристики удаляются автоматически
3. **Фильтрация**: Характеристики можно использовать для фильтрации товаров
4. **Отображение**: Основные характеристики отображаются в карточках товаров

## Техническая информация

### База данных
- **Индексы**: Созданы индексы для быстрого поиска по product_id и spec_name
- **Триггеры**: Автоматическое обновление updated_at при изменении записи
- **Ограничения**: Внешний ключ на таблицу products с каскадным удалением

### Производительность
- Запросы оптимизированы для быстрого получения характеристик
- Поддержка пагинации для больших наборов данных
- Кэширование на уровне приложения

### Безопасность
- Валидация входящих данных на уровне API
- Защита от SQL-инъекций через параметризованные запросы
- Логирование всех операций изменения данных

## Заключение

Система характеристик товаров обеспечивает гибкое и мощное управление свойствами продуктов в каталоге МедСИП. Правильное использование типов характеристик, единиц измерения и приоритетов позволяет создать информативный и удобный для пользователей каталог медицинских товаров. 