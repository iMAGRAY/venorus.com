# Руководство по вариантам товаров

## Обзор

Функционал вариантов товаров позволяет создавать несколько версий одного товара с различающимися характеристиками (размер, цвет, комплектация и т.д.) и ценами. Каждый вариант может иметь полную настройку, как у обычного товара, включая собственные изображения, описания, характеристики и SEO-настройки.

## Основные возможности

### Для администраторов:
- Добавление неограниченного количества вариантов для каждого товара
- Полная настройка каждого варианта (как у обычного товара):
  - Название и описание варианта
  - Собственные изображения
  - Индивидуальные цены и скидки
  - Характеристики и спецификации
  - SEO-настройки (meta-теги)
  - Гарантия и время работы от батареи
- Управление складскими остатками по каждому варианту
- Установка артикулов (SKU) для каждого варианта
- Управление доступностью и статусами (новинка, хит, рекомендуемый)
- Сортировка вариантов

### Для покупателей:
- Выбор варианта товара на странице товара
- Отображение изображений выбранного варианта
- Отображение актуальной цены и наличия для выбранного варианта
- Поиск по вариантам товаров
- Отображение диапазона цен в каталоге
- Рекомендуемые варианты выделяются специальным значком

## Работа с вариантами в админ-панели

### Добавление вариантов

1. Перейдите в раздел "Товары" админ-панели
2. Выберите товар для редактирования или создайте новый
3. Перейдите на вкладку "Варианты"
4. Нажмите кнопку "Добавить вариант"
5. В открывшейся форме доступны следующие вкладки:

#### Вкладка "Основное"
- **Название варианта** (обязательно) - например, "Размер L", "Синий", "Базовая комплектация"
- **Значение варианта** - дополнительное описание, например "42-44", "Pantone 286C"
- **Полное название** - развернутое название варианта для SEO
- **Описание** - подробное описание особенностей варианта
- **Гарантия** - гарантийный срок для данного варианта
- **Время работы от батареи** - если применимо
- **Статусы**:
  - Доступен для заказа
  - Рекомендуемый
  - Новинка
  - Хит продаж

#### Вкладка "Цены и склад"
- **Артикул (SKU)** - уникальный артикул варианта
- **Порядок сортировки** - для управления порядком отображения
- **Цена** - базовая цена варианта
- **Цена со скидкой** - актуальная цена при наличии скидки
- **Количество на складе** - текущий остаток
- **Вес** - вес варианта в килограммах

#### Вкладка "Изображения"
- Загрузка до 8 изображений для варианта
- Изображения варианта заменяют основные изображения товара при выборе

#### Вкладка "Характеристики"
- Добавление специфичных характеристик для варианта
- Характеристики варианта дополняют основные характеристики товара

#### Вкладка "SEO"
- **Meta заголовок** - SEO заголовок страницы с выбранным вариантом
- **Meta описание** - SEO описание для поисковых систем
- **Ключевые слова** - ключевые слова для SEO

### Редактирование вариантов

1. В списке вариантов нажмите кнопку редактирования (иконка карандаша)
2. Откроется та же форма с заполненными данными
3. Измените необходимые поля на любой из вкладок
4. Нажмите "Сохранить"

### Управление доступностью

- Используйте переключатель "Доступен для заказа" для временного скрытия варианта
- Недоступные варианты не отображаются покупателям

## Отображение на сайте

### В каталоге товаров

- Если у товара есть варианты, отображается минимальная цена с префиксом "от"
- Товары с вариантами не дублируются в списке

### На странице товара

- Варианты отображаются в виде радио-кнопок
- При выборе варианта обновляется:
  - Цена товара
  - Статус наличия
  - Артикул (если указан для варианта)
- Первый доступный вариант выбирается автоматически

### В корзине

- Варианты отображаются как часть названия товара
- Цена соответствует выбранному варианту

## Поиск

- Поиск работает по названиям и артикулам вариантов
- В результатах поиска отображаются товары, у которых есть подходящие варианты

## Техническая информация

### Структура базы данных

Варианты хранятся в таблице `product_sizes` с расширенным набором полей:

```sql
CREATE TABLE product_sizes (
    id SERIAL PRIMARY KEY,
    product_id INTEGER REFERENCES products(id),
    size_name VARCHAR(255) NOT NULL,
    size_value VARCHAR(255),
    name VARCHAR(500),
    description TEXT,
    sku VARCHAR(100),
    price DECIMAL(12,2),
    discount_price DECIMAL(12,2),
    stock_quantity INTEGER DEFAULT 0,
    weight DECIMAL(10,3),
    dimensions JSONB,
    specifications JSONB,
    is_available BOOLEAN DEFAULT true,
    sort_order INTEGER DEFAULT 0,
    image_url VARCHAR(500),
    images JSONB DEFAULT '[]'::jsonb,
    warranty VARCHAR(255),
    battery_life VARCHAR(255),
    meta_title VARCHAR(255),
    meta_description TEXT,
    meta_keywords TEXT,
    is_featured BOOLEAN DEFAULT false,
    is_new BOOLEAN DEFAULT false,
    is_bestseller BOOLEAN DEFAULT false,
    custom_fields JSONB DEFAULT '{}'::jsonb,
    characteristics JSONB DEFAULT '[]'::jsonb,
    selection_tables JSONB DEFAULT '[]'::jsonb,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

### API endpoints

#### Получение вариантов товара
```
GET /api/products/{productId}/sizes
```

#### Создание варианта
```
POST /api/product-sizes
Body: {
  productId: number,
  sizeName: string,
  sizeValue?: string,
  sku?: string,
  price?: number,
  discountPrice?: number,
  stockQuantity?: number,
  isAvailable?: boolean
}
```

#### Обновление варианта
```
PUT /api/product-sizes/{id}
```

#### Удаление варианта
```
DELETE /api/product-sizes/{id}
```

### Компоненты

- `ProductVariantSelector` - компонент выбора варианта на странице товара
- `ProductVariantsManager` - компонент управления вариантами в админ-панели

## Рекомендации по использованию

1. **Названия вариантов** - используйте понятные и консистентные названия
2. **Артикулы** - обязательно указывайте уникальные артикулы для учета
3. **Сортировка** - варианты сортируются по полю sort_order, затем по названию
4. **Цены** - если у варианта не указана цена, он отображается как "По запросу"
5. **Складские остатки** - регулярно обновляйте количество для корректного отображения наличия

## Примеры использования

### Одежда
- Варианты: размеры (S, M, L, XL)
- Разные цены для больших размеров

### Медицинское оборудование
- Варианты: комплектации (базовая, расширенная, профессиональная)
- Существенная разница в цене между комплектациями

### Расходные материалы
- Варианты: объем упаковки (10 шт, 50 шт, 100 шт)
- Скидки при покупке больших упаковок